<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>매칭설문창</title>
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  </head>
  <style>
    .selected {
      background-color: #4caf50;
      /* 선택되었을 때의 배경색 */
      color: white;
      /* 선택되었을 때의 글자색 */
    }
    /* .radio {
      background-color: gray;
    } */
  </style>

  <body class="bg-white">
    {% include 'header.html'%}
    <div class="container mx-auto p-16">
      <div id="progress-text" class="text-center mb-4">1/3</div>
      <div class="w-full bg-gray-200 rounded-full h-5 mb-4">
        <div
          id="progress-bar"
          class="bg-blue-600 h-5 rounded-full"
          style="width: 25%"
        ></div>
      </div>
    </div>
    <div class="bg-blue-500 p-8 pb-96">
      <div class="flex-col container justify-center items-center mx-auto">
        <div id="form-1" class="bg-white p-6 rounded-lg shadow-lg mb-6">
          <h2 class="text-xl font-bold mb-4">
            1.참여하고싶은 스터디 주제를 선택해주세요.
          </h2>
          <p class="mb-4">
            없다면 + 버튼으로 추가할 수 있어요. 최대 3개까지 선택 가능합니다.
          </p>
          {% include 'subjects.html'%}
        </div>
        <div id="form-2" class="bg-white p-6 rounded-lg shadow-lg mb-6 hidden">
          <h2 class="text-xl font-bold mb-4">
            2.오프라인 스터디를 선호하시나요? 아니면 온라인 스터디를
            선호하시나요?
          </h2>

          <div class="flex">
            <select
              id="on-off"
              class="mt-1 block w-1/3 pl-3 py-2 text-base border border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
            >
              <option value="option1">온라인</option>
              <option value="option2">오프라인</option>
            </select>
            <select
              id="offline"
              class="mt-1 block w-2/3 pl-3 pr-10 py-2 text-base border border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md hidden"
            >
              {% for location in locations %}
              <option>{{location}}</option>
              {% endfor %}
            </select>
            <select
              id="online"
              class="mt-1 block w-2/3 pl-3 pr-10 py-2 text-base border border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
            >
              {% for platform in platforms %}
              <option>{{platform}}</option>
              {% endfor %}
            </select>
          </div>
        </div>
        <div
          id="form-3"
          class="same-question bg-white p-6 rounded-lg shadow-lg mb-6 hidden"
        >
          <h2 class="text-xl font-bold mb-4">
            3-1.어떤 요일에 스터디 하기 원하시나요?
          </h2>
          <p class="mb-4">
            스터디 참여가 가능한 요일을 선택해주세요.(복수응답 가능)
          </p>
          <div class="flex flex-wrap gap-2">
            {% for day in week %}
            <input
              type="text"
              id="keyword1"
              value="{{day}}"
              readonly
              class="week w-full bg-gray-200 p-2 text-gray-700 focus:outline-none rounded-md h-10 drag-n cursor-pointer toggle"
            />

            {% endfor %}
          </div>
        </div>
        <div
          id="form-3"
          class="same-question bg-white p-6 rounded-lg shadow-lg mb-6 hidden"
        >
          <h2 class="text-xl font-bold mb-4">
            3-2.원하는 스터디 주제의 난이도가 있으신가요?.
          </h2>
          <p class="mb-4">사용자가 원하는 스터디 난이도를 알려주세요!</p>
          <div class="flex flex-wrap gap-2">
            {% for level in levels %}
            <div
              class="bg-gray-200 text-gray-700 px-3 py-2 rounded-lg focus:outline-none drag-n toggle"
              data-keyword="keyword1"
            >
              {{level}}
            </div>

            {% endfor %}
          </div>
        </div>
        <div
          id="form-3"
          class="same-question bg-white p-6 rounded-lg shadow-lg mb-6 hidden"
        >
          <h2 class="text-xl font-bold mb-4">
            3-3.스터디 분위기가 어땠으면 좋겠나요?
          </h2>
          <p class="mb-4"></p>
          <div class="flex flex-wrap gap-2">
            {% for mood in moods %}
            <div
              class="bg-gray-200 text-gray-700 px-3 py-2 rounded-lg focus:outline-none drag-n toggle"
              data-keyword="keyword1"
            >
              {{mood}}
            </div>
            {% endfor %}
          </div>
        </div>
      </div>
    </div>
    <div class="flex container justify-between mx-auto pt-8">
      <button
        id="prev-btn"
        class="bg-blue-600 text-white py-2 px-4 rounded"
        onclick="prevStep()"
        disabled
      >
        Previous
      </button>
      <button
        id="next-btn"
        class="bg-blue-600 text-white py-2 px-4 rounded"
        onclick="nextStep()"
      >
        Next
      </button>
    </div>
    <script src="/static/Script.js"></script>
    <script>
      let currentStep = 1;

      function updateProgress() {
        const progressBar = document.getElementById("progress-bar");
        const progressText = document.getElementById("progress-text");
        progressBar.style.width = `${currentStep * 33.33}%`;
        progressText.innerText = `${currentStep}/3`;
      }

      function nextStep() {
        let checked = false;
        const selectedToggles = $("input.selected");
        if (selectedToggles.length === 0) {
          alert("질문에 대한 답을 골라주세요.");
          return;
        }

        console.log("currentStep: " + currentStep);

        document.getElementById(`form-${currentStep}`).classList.add("hidden");
        currentStep++;

        if (currentStep < 3) {
          // console.log("4");

          document
            .getElementById(`form-${currentStep}`)
            .classList.remove("hidden");
          document.getElementById("prev-btn").disabled = false;

          updateProgress();
        }
        if (currentStep === 3) {
          console.log("remove hidden");
          list = document.getElementsByClassName("same-question");
          for (let i = 0; i < list.length; i++) {
            list[i].classList.remove("hidden");
          }
        }
        if (currentStep === 4) {
          window.location.href = "/matching_result";
        }
      }

      function prevStep() {
        console.log("currentStep:" + currentStep);
        if (currentStep > 1) {
          document
            .getElementById(`form-${currentStep}`)
            .classList.add("hidden");
          currentStep--;
          document
            .getElementById(`form-${currentStep}`)
            .classList.remove("hidden");
          document.getElementById("next-btn").disabled = false;
          if (currentStep == 1) {
            document.getElementById("prev-btn").disabled = true;
          }
          if (currentStep === 2) {
            // console.log("remove hidden");
            list = document.getElementsByClassName("same-question");
            for (let i = 0; i < list.length; i++) {
              list[i].classList.add("hidden");
            }
          }
          updateProgress();
        }
      }
    </script>
  </body>
</html>
